<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Camera Capture</title>
  <style>
    /* Add any additional styling here */
    .red-button-class {
      background-color: red;
      color: white;
    }
  </style>
</head>
<body>

<video autoplay muted playsinline id="video"></video>
<button id="grabFrameButton" disabled>Grab Frame</button>
<button id="takePhotoButton" disabled>Take Photo</button>

<!-- Add the SweetAlert library -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

<script>
  let imageCapture;
  let mediaStream;

  navigator.mediaDevices.getUserMedia({
    video: {
      width: { ideal: 640 },
      height: { ideal: 480 },
    },
  }).then((stream) => {
    mediaStream = stream;
    document.querySelector("video").srcObject = stream;
    
    const track = mediaStream.getVideoTracks()[0];
    
    if (track) {
      imageCapture = new ImageCapture(track);

      // Enable buttons when the video starts playing
      document.querySelector("video").addEventListener("play", () => {
        document.querySelector("#grabFrameButton").disabled = false;
        document.querySelector("#takePhotoButton").disabled = false;
      });
    } else {
      // Handle the case where no video track is available
      console.error("No video track available.");
    }
  }).catch((error) => {
    console.error(error);

    // Display SweetAlert on error
    Swal.fire({
      title: '<i class="fa-solid fa-video-slash"></i>',
      text: "Device in use in another browser. Kindly check.",
      icon: null, // Set icon to null to use HTML for the title
      buttons: true,
      dangerMode: true,
      allowOutsideClick: false,
      customClass: {
        confirmButton: 'red-button-class',
        cancelButton: 'red-button-class'
      }
    });
  });
</script>

</body>
</html>
